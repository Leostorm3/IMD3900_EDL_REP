<!DOCTYPE html>
<html>
    <head>
        <title>these are the puzzle testing</title>
        <meta name="description" content="Hello, WebVR! - A-Frame">
        <script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
        <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
        <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.2.0/dist/aframe-extras.min.js"></script>
        <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.3.0/dist/aframe-physics-system.min.js"></script>
        <script src="https://unpkg.com/aframe-event-set-component@^4.0.0/dist/aframe-event-set-component.min.js"></script>
        <script src="https://unpkg.com/super-hands@3.0.0/dist/super-hands.min.js"></script>
        <script src="https://unpkg.com/aframe-html-shader@0.2.0/dist/aframe-html-shader.min.js"></script>
        <script>
            // forward mouse and touch events to the super-hands entity
            AFRAME.registerComponent('capture-mouse', {
              init: function () {
                this.eventRepeater = this.eventRepeater.bind(this)
                this.el.sceneEl.addEventListener('loaded', () => {
                  this.el.sceneEl.canvas.addEventListener('mousedown', this.eventRepeater)
                  this.el.sceneEl.canvas.addEventListener('mouseup', this.eventRepeater)
                  this.el.sceneEl.canvas.addEventListener('touchstart', this.eventRepeater)
                  this.el.sceneEl.canvas.addEventListener('touchmove', this.eventRepeater)
                  this.el.sceneEl.canvas.addEventListener('touchend', this.eventRepeater)
                }, {once: true})
              },
              eventRepeater: function (evt) {
                if (evt.type.startsWith('touch')) {
                  evt.preventDefault()
                  // avoid repeating touchmove because it interferes with look-controls
                  if (evt.type === 'touchmove') { return }
                }
                this.el.emit(evt.type, evt.detail)
              }
            })
          </script>
    </head>
    <body>
        <!-- main scene and we added shadows .. -->
        <a-scene  inspector-plugin-recast shadow="type: pcfsoft" physics="debug: false; friction: 0.1; restitution: 0.2; gravity: -9.8" avatar-recorder touch-to-click-converter stats>
                <a-assets timeout="3000">

                    <!-- all assets that can be cached by browser -->
                    <img crossorigin="anonymous" id="environment" src="/assets/textures/Texture.png">        
                    <a-asset-item crossorigin="anonymous" id="environment-obj" src="/assets/models/Environment.obj"></a-asset-item>   
                    <a-mixin id="cube" geometry="primitive: box; width: 0.33; height: 0.33; depth: 0.33"
                    hoverable grabbable stretchable draggable droppable
                    event-set__hoveron="_event: hover-start; material.opacity: 0.5; transparent: true"
                    event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                    dynamic-body shadow></a-mixin>              

                    <!-- use this method if you are having problems with sound playing -->
                    <!-- sounds from "SuperSays" project : https://github.com/supermedium/supersays/tree/master/src/assets -->
                    
                </a-assets>

                <!-- traditional method of creating a camera and cursor component for selection. select with reticle. -->
                <!-- Also added in controls for desktop mouse/kb -->
                <a-entity id="rig" position="-7 0 8"  movement-controls="controls:keyboard, touch; speed:0.2; constrainToNavMesh: true">
                <a-entity id="head" position="0 2.5 0" camera="userHeight:2.5"  look-controls="pointerLockEnabled:true"  capture-mouse
                raycaster cursor="rayOrigin:mouse"
                static-body="shape: sphere; sphereRadius: 0.001"
                super-hands="colliderEvent: raycaster-intersection;
                             colliderEventProperty: els;
                             colliderEndEvent:raycaster-intersection-cleared;
                             colliderEndEventProperty: clearedEls;">
                    <a-entity scale="0.1 0.1 0.1" light="type: spot; angle:30 decay:2; distance:15; castShadow:true; penumbra:0.5; shadowMapHeight: 350; shadowMapWidth: 350; shadowRadius:2; shadowCameraVisible: false;"  rotation="0 0 0" position="0 0 -1"></a-entity>
                    <a-entity cursor="fuse:true; fuseTimeout:500;"
                    position="0 0 -0.1"
                    scale="0.1 0.1 0.1"
                    geometry="primitive:circle; radius:0.003;"
                    material="shader:flat; color:white">
                   
                   <a-entity position="1 -0.5 -0.1"  scale="1 0.5 0.1" geometry="primitive: plane" material="shader: html; target: #htmlElement"></a-entity>
                
                </a-entity>
                  
                  </a-entity>
                
                </a-entity>


                <!-- default lighting added in manually -->
                <a-sky color="#270d2c"></a-sky>
            
                <a-entity light="type: directional; color: #ffffff; intensity: 0.05; " position="31 80 -50" ></a-entity>
                <a-entity light="type: hemisphere; color: white; groundColor: #5424ff; intensity: 0.1"></a-entity>
                
                <a-entity obj-model="obj: #environment-obj"
                material="src: #environment"
                position="0 0 0"
                scale="1.5 1.5 1.5"
                body="type: static; shape: none;"
                    shape__left="shape: box; halfExtents: 0.1 1.47 4; offset: -7.45 1.47 3.9;"
                    shape__right="shape: box; halfExtents: 0.1 1.47 4; offset: -1.97 1.47 3.9;"
                    shape__front="shape: box; halfExtents: 2.66 1.47 0.1; offset: -4.71 1.47 -0.2;"
                    shape__back="shape: box; halfExtents: 2.66 1.47 0.1; offset: -4.71 1.47 7.87;"
                    shape__bottom="shape: box; halfExtents: 2.68 0.1 4; offset: -4.75 -0.1 3.9;"
                    shape__top="shape: box; halfExtents: 2.68 0.1 4; offset: -4.75 3.07 3.9;"
                    shadow="receive: true">
                </a-entity>
                <!-- plane so we can see shadows -->  
                
                
                <!-- manual method of creating "sky sphere" -->

                <a-entity position="0 0 0" material="src: #environment"   gltf-model="/assets/models/navmesh.gltf" nav-mesh visible="false"></a-entity>



                <a-entity shadow="cast: true" class="cube" mixin="cube" position="-8 1.8 4" material="color: red">
                </a-entity>

                

                    <a-box color="red"  dynamic-body="shape: box; mass: 2" position="-5 1.8 4" rotation="0 30 0" scale="0.5 0.5 0.5" > 
                          
                      </a-box>
        
                      <a-box  color="blue"  position="2 0.2 -3" rotation="0 -30 0" scale="0.5 0.5 0.5" >
                              
                          </a-box>


        </a-scene>
        <div style="width: 100%; height: 100%; position: fixed; left: 0; top: 0; z-index: -1; overflow: hidden">
            <div id="htmlElement" style="width: 512px; height: 256px; background: #F8F8F8; color: #333; font-size: 24px">Hello, HTML!</div>
          </div>
    </body>
</html>
